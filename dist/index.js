(()=>{var b=class{constructor(e,i,n,o){this.r=e,this.g=i,this.b=n,this.a=o}},w=class{constructor(){this.scaleX=1,this.scaleY=1,this.offsetX=0,this.offsetY=0,this.loop=!1,this._vbuffer=0,this._coord=0,this.visible=!0,this.intensity=1,this.xy=new Float32Array([]),this.numPoints=0,this.color=new b(0,0,0,1),this.webglNumPoints=0}},v=class extends w{constructor(e,i){super(),this.currentIndex=0,this.webglNumPoints=i,this.numPoints=i,this.color=e,this.xy=new Float32Array(2*this.webglNumPoints)}setX(e,i){this.xy[e*2]=i}setY(e,i){this.xy[e*2+1]=i}getX(e){return this.xy[e*2]}getY(e){return this.xy[e*2+1]}lineSpaceX(e,i){for(let n=0;n<this.numPoints;n++)this.setX(n,e+i*n)}arrangeX(){this.lineSpaceX(-1,2/this.numPoints)}constY(e){for(let i=0;i<this.numPoints;i++)this.setY(i,e)}shiftAdd(e){let i=e.length;for(let n=0;n<this.numPoints-i;n++)this.setY(n,this.getY(n+i));for(let n=0;n<i;n++)this.setY(n+this.numPoints-i,e[n])}addArrayY(e){if(this.currentIndex+e.length<=this.numPoints)for(let i=0;i<e.length;i++)this.setY(this.currentIndex,e[i]),this.currentIndex++}replaceArrayY(e){if(e.length==this.numPoints)for(let i=0;i<this.numPoints;i++)this.setY(i,e[i])}};var M=(c,e,i)=>{let n={x:0,y:0};return n.x=c.x+e.x*i,n.y=c.y+e.y*i,n},_=c=>P(-c.y,c.x),p=(c,e)=>{let i=R(c,e);return i=Y(i),i},S=(c,e)=>{let i={x:0,y:0};return i.x=c.x+e.x,i.y=c.y+e.y,i},N=(c,e)=>c.x*e.x+c.y*e.y,Y=c=>{let e={x:0,y:0},i=c.x*c.x+c.y*c.y;return i>0&&(i=1/Math.sqrt(i),e.x=c.x*i,e.y=c.y*i),e},P=(c,e)=>{let i={x:0,y:0};return i.x=c,i.y=e,i},R=(c,e)=>{let i={x:0,y:0};return i.x=c.x-e.x,i.y=c.y-e.y,i},T=c=>{let e,i={x:0,y:0},n={x:0,y:0},o=[],r=(s,a)=>{o.push({vec2:s,miterLength:a})},h=s=>({x:c[s*2],y:c[s*2+1]});i=p(h(1),h(0)),e=_(i),r(e,1);let l=c.length/2;for(let s=1;s<l-1;s++){let a=h(s-1),t=h(s),u=h(s+1);i=p(t,a),e=_(i),n=p(u,t);let f=C(i,n),m=F(i,f,1);r(f,m)}return i=p(h(l-1),h(l-2)),e=_(i),r(e,1),o},C=(c,e)=>{let i=S(c,e);return i=Y(i),P(-i.y,i.x)},F=(c,e,i)=>{let n=P(-c.y,c.x);return i/N(e,n)},x=class extends w{constructor(e,i,n){super(),this.currentIndex=0,this._thicknessRequested=0,this._actualThickness=0,this.webglNumPoints=i*2,this.numPoints=i,this.color=e,this._thicknessRequested=n,this._linePoints=new Float32Array(i*2),this.xy=new Float32Array(2*this.webglNumPoints)}convertToTriPoints(){let e=this._actualThickness/2,i=T(this._linePoints);for(let n=0;n<this.numPoints;n++){let o=this._linePoints[2*n],r=this._linePoints[2*n+1],h={x:o,y:r},l=M(h,i[n].vec2,i[n].miterLength*e),s=M(h,i[n].vec2,-i[n].miterLength*e);this.xy[n*4]=l.x,this.xy[n*4+1]=l.y,this.xy[n*4+2]=s.x,this.xy[n*4+3]=s.y}}setX(e,i){this._linePoints[e*2]=i}setY(e,i){this._linePoints[e*2+1]=i}lineSpaceX(e,i){for(let n=0;n<this.numPoints;n++)this.setX(n,e+i*n)}setThickness(e){this._thicknessRequested=e}getThickness(){return this._thicknessRequested}setActualThickness(e){this._actualThickness=e}},L=class{constructor(e,i){this.debug=!1,this.addLine=this.addDataLine,i==null?this.webgl=e.getContext("webgl",{antialias:!0,transparent:!1}):(this.webgl=e.getContext("webgl",{antialias:i.antialias,transparent:i.transparent,desynchronized:i.deSync,powerPerformance:i.powerPerformance,preserveDrawing:i.preserveDrawing}),this.debug=i.debug==null?!1:i.debug),this.log("canvas type is: "+e.constructor.name),this.log(`[webgl-plot]:width=${e.width}, height=${e.height}`),this._linesData=[],this._linesAux=[],this._thickLines=[],this._surfaces=[],this.gScaleX=1,this.gScaleY=1,this.gXYratio=1,this.gOffsetX=0,this.gOffsetY=0,this.gLog10X=!1,this.gLog10Y=!1,this.webgl.clear(this.webgl.COLOR_BUFFER_BIT),this.webgl.viewport(0,0,e.width,e.height),this._progLine=this.webgl.createProgram(),this.initThinLineProgram(),this.webgl.enable(this.webgl.BLEND),this.webgl.blendFunc(this.webgl.SRC_ALPHA,this.webgl.ONE_MINUS_SRC_ALPHA)}get linesData(){return this._linesData}get linesAux(){return this._linesAux}get thickLines(){return this._thickLines}get surfaces(){return this._surfaces}_drawLines(e){let i=this.webgl;e.forEach(n=>{if(n.visible){i.useProgram(this._progLine);let o=i.getUniformLocation(this._progLine,"uscale");i.uniformMatrix2fv(o,!1,new Float32Array([n.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,n.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let r=i.getUniformLocation(this._progLine,"uoffset");i.uniform2fv(r,new Float32Array([n.offsetX+this.gOffsetX,n.offsetY+this.gOffsetY]));let h=i.getUniformLocation(this._progLine,"is_log");i.uniform2iv(h,new Int32Array([this.gLog10X?1:0,this.gLog10Y?1:0]));let l=i.getUniformLocation(this._progLine,"uColor");i.uniform4fv(l,[n.color.r,n.color.g,n.color.b,n.color.a]),i.bufferData(i.ARRAY_BUFFER,n.xy,i.STREAM_DRAW),i.drawArrays(n.loop?i.LINE_LOOP:i.LINE_STRIP,0,n.webglNumPoints)}})}_drawSurfaces(e){let i=this.webgl;e.forEach(n=>{if(n.visible){i.useProgram(this._progLine);let o=i.getUniformLocation(this._progLine,"uscale");i.uniformMatrix2fv(o,!1,new Float32Array([n.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,n.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let r=i.getUniformLocation(this._progLine,"uoffset");i.uniform2fv(r,new Float32Array([n.offsetX+this.gOffsetX,n.offsetY+this.gOffsetY]));let h=i.getUniformLocation(this._progLine,"is_log");i.uniform2iv(h,new Int32Array([this.gLog10X?1:0,this.gLog10Y?1:0]));let l=i.getUniformLocation(this._progLine,"uColor");i.uniform4fv(l,[n.color.r,n.color.g,n.color.b,n.color.a]),i.bufferData(i.ARRAY_BUFFER,n.xy,i.STREAM_DRAW),i.drawArrays(i.TRIANGLE_STRIP,0,n.webglNumPoints)}})}_drawTriangles(e){let i=this.webgl;i.bufferData(i.ARRAY_BUFFER,e.xy,i.STREAM_DRAW),i.useProgram(this._progLine);let n=i.getUniformLocation(this._progLine,"uscale");i.uniformMatrix2fv(n,!1,new Float32Array([e.scaleX*this.gScaleX*(this.gLog10X?1/Math.log(10):1),0,0,e.scaleY*this.gScaleY*this.gXYratio*(this.gLog10Y?1/Math.log(10):1)]));let o=i.getUniformLocation(this._progLine,"uoffset");i.uniform2fv(o,new Float32Array([e.offsetX+this.gOffsetX,e.offsetY+this.gOffsetY]));let r=i.getUniformLocation(this._progLine,"is_log");i.uniform2iv(r,new Int32Array([0,0]));let h=i.getUniformLocation(this._progLine,"uColor");i.uniform4fv(h,[e.color.r,e.color.g,e.color.b,e.color.a]),i.drawArrays(i.TRIANGLE_STRIP,0,e.xy.length/2)}_drawThickLines(){this._thickLines.forEach(e=>{if(e.visible){let i=Math.min(this.gScaleX,this.gScaleY);e.setActualThickness(e.getThickness()/i),e.convertToTriPoints(),this._drawTriangles(e)}})}update(){this.clear(),this.draw()}draw(){this._drawLines(this.linesData),this._drawLines(this.linesAux),this._drawThickLines(),this._drawSurfaces(this.surfaces)}clear(){this.webgl.clear(this.webgl.COLOR_BUFFER_BIT)}_addLine(e){e._vbuffer=this.webgl.createBuffer(),this.webgl.bindBuffer(this.webgl.ARRAY_BUFFER,e._vbuffer),this.webgl.bufferData(this.webgl.ARRAY_BUFFER,e.xy,this.webgl.STREAM_DRAW),e._coord=this.webgl.getAttribLocation(this._progLine,"coordinates"),this.webgl.vertexAttribPointer(e._coord,2,this.webgl.FLOAT,!1,0,0),this.webgl.enableVertexAttribArray(e._coord)}addDataLine(e){this._addLine(e),this.linesData.push(e)}addAuxLine(e){this._addLine(e),this.linesAux.push(e)}addThickLine(e){this._addLine(e),this._thickLines.push(e)}addSurface(e){this._addLine(e),this.surfaces.push(e)}initThinLineProgram(){let e=`
      attribute vec2 coordinates;
      uniform mat2 uscale;
      uniform vec2 uoffset;
      uniform ivec2 is_log;

      void main(void) {
         float x = (is_log[0]==1) ? log(coordinates.x) : coordinates.x;
         float y = (is_log[1]==1) ? log(coordinates.y) : coordinates.y;
         vec2 line = vec2(x, y);
         gl_Position = vec4(uscale*line + uoffset, 0.0, 1.0);
      }`,i=this.webgl.createShader(this.webgl.VERTEX_SHADER);this.webgl.shaderSource(i,e),this.webgl.compileShader(i);let n=`
         precision mediump float;
         uniform highp vec4 uColor;
         void main(void) {
            gl_FragColor =  uColor;
         }`,o=this.webgl.createShader(this.webgl.FRAGMENT_SHADER);this.webgl.shaderSource(o,n),this.webgl.compileShader(o),this._progLine=this.webgl.createProgram(),this.webgl.attachShader(this._progLine,i),this.webgl.attachShader(this._progLine,o),this.webgl.linkProgram(this._progLine)}popDataLine(){this.linesData.pop()}removeAllLines(){this._linesData=[],this._linesAux=[],this._thickLines=[],this._surfaces=[]}removeDataLines(){this._linesData=[]}removeAuxLines(){this._linesAux=[]}viewport(e,i,n,o){this.webgl.viewport(e,i,n,o)}log(e){this.debug&&console.log("[webgl-plot]:"+e)}};var g=class{constructor(){this.plots={}}initPlot(e,i){if(i||(i=new L(e.canvas,e.webglOptions)),!e._id)e._id=`plot${Math.floor(Math.random()*1e15)}`;else if(this.plots[e._id]){let a=this.plots[e._id].initial;if(e.lines){for(let t in e.lines)if(a.lines[t]&&Array.isArray(e.lines[t])){let u=e.lines[t];e.lines[t]=a.lines[t]}}e=Object.assign(a,e)}e.overlay&&(typeof e.overlay!="object"&&(e.overlay=document.createElement("canvas"),e.overlay.style.position="absolute",e.overlay.width=e.canvas.width,e.overlay.height=e.canvas.height,e.canvas.appendChild(e.overlay)),e.overlayCtx||(e.overlayCtx=e.overlay.getContext("2d"))),e.width&&(e.canvas.width=e.width,e.canvas.style&&(e.canvas.style.width=e.width+"px"),typeof e.overlay=="object"&&(e.overlay.width=e.width,e.overlay.style&&(e.overlay.style.width=e.width+"px"))),e.height&&(e.canvas.height=e.height,e.canvas.style&&(e.canvas.style.height=e.height+"px"),typeof e.overlay=="object"&&(e.overlay.height=e.height,e.overlay.style&&(e.overlay.style.height=e.height+"px"))),e.lines?.timestamp&&delete e.lines.timestamp;let n={};for(let a in e.lines)n[a]=Object.assign({},n[a]),"viewing"in e.lines[a]||(e.lines[a].viewing=!0),n[a].viewing=e.lines[a].viewing,n[a].sps=e.lines[a].sps,n[a].nSec=e.lines[a].nSec,n[a].nPoints=e.lines[a].nPoints,n[a].ymin=e.lines[a].ymin,n[a].ymax=e.lines[a].ymax,n[a].units=e.lines[a].units;let o={plot:i,settings:e,initial:Object.assign(Object.assign({},e),{lines:n}),anim:()=>{i.update()}};this.plots[e._id]=o;let r=0,h=0;Object.keys(e.lines).forEach(a=>{e.lines[a]?.viewing!==!1&&h++}),e.nLines=h;let l,s;typeof e.overlay=="object"&&(l=e.overlay,s=e.overlayCtx,s.clearRect(0,0,e.overlay.width,e.overlay.height),s.font=e.overlayFont?e.overlayFont:"1vw Courier",s.fillStyle=e.overlayColor?e.overlayColor:"white");for(let a in e.lines){let t=e.lines[a];if(Array.isArray(t)&&(t={values:t},e.lines[a]=t),"viewing"in t||(t.viewing=!0),t.color)Array.isArray(t.color)&&(t.color=new b(...t.color));else{let y=g.HSLToRGB(360*(r/h)%360,100,50,1);o.initial.lines[a].color=[...y,1],t.color=new b(...y,1)}let u;if(t.nSec&&t.sps?u=Math.ceil(t.nSec*t.sps):t.nPoints?u=t.nPoints:t.values?u=t.values.length:u||(u=1e3),!u)return;if(t.points=u,e.lines[a].viewing===!1)continue;t.width?(t.line=new x(t.color,u,t.width),t.line.lineSpaceX(-1,2/t.line.numPoints)):(t.line=new v(t.color,u),t.line.arrangeX()),t.values?.length===t.points?t.values.length!==u&&(t.interpolate?t.values.length>u?t.values=g.downsample(t.values,u):t.values.length<u&&(t.values=g.upsample(t.values,u)):t.values.length>t.points?t.values=t.values.slice(t.values.length-t.points):t.values=[...new Array(t.points-t.values.length).fill(0),...t.values]):Array.isArray(t.values)?t.values=[...new Array(u-t.values.length).fill(0),...t.values]:t.values=new Array(t.points).fill(0),isNaN(t.ymax)&&(isNaN(t.ymin)?t.ymax=0:t.ymax=t.values.length<=1e5?Math.max(...t.values):1),isNaN(t.ymin)&&(isNaN(t.ymax)||(t.ymin=t.values.length<=1e5?Math.min(...t.values):1),t.ymin=0);let f=t.ymin,m=t.ymax;if(f===m)m=t.values.length<=1e5?Math.max(...t.values):1,f=t.values.length<=1e5?Math.min(...t.values):0,t.ymax=m,t.ymin=f;else if(typeof o.initial.lines[a]?.ymin!="number"&&(e.overlay||t.autoscale)){m=t.values.length<=1e5?Math.max(...t.values,t.ymax):1,f=t.values.length<=1e5?Math.min(...t.values,t.ymin):0,t.ymin=f,t.ymax=m;let y=Math.abs(t.ymin);t.absmax=y>t.ymax?y:t.ymax}else typeof t.ymax=="number"&&(typeof t.ymin!="number"&&(t.ymin=0),t.ymin>t.ymax&&(m=t.ymin,t.ymin=t.ymax,t.ymax=m));typeof f!="number"&&(f=t.values.length<=1e5?Math.min(...t.values,t.ymin):0),typeof m!="number"&&(m=t.values.length<=1e5?Math.max(...t.values,t.ymax):1);let d=Math.abs(t.ymin);if(t.absmax=d>t.ymax?d:t.ymax,"autoscale"in t||(t.autoscale=!0),t.position||(t.position=e.nLines-r-1),t.autoscale?("clamp"in t||(t.clamp=!0),t.autoscale===2?t.scaled=g.autoscale(t.values,t.position,h,t.centerZero,f,m,t.clamp):(t.scaled=t.values,t.line.offsetY=g.getYOffset(t.position,h),t.line.scaleY=g.getYScalar(t.values,h,t.centerZero,f,m))):t.scaled=t.values,t.scaled.forEach((y,A)=>t.line.setY(A,y)),t.line instanceof x?i.addThickLine(t.line):t.line instanceof v&&i.addDataLine(t.line),"xAxis"in t||(t.xAxis=!0),t.xAxis){t.xColor?Array.isArray(t.xColor)&&(t.xColor=new b(...t.xColor)):t.xColor=new b(1,1,1,.3);let y=new v(t.xColor,2),A=t.autoscale?(r+1)*2/h-1-1/h:0;y.constY(A),y.arrangeX(),y.xy[2]=1,t.x=y,i.addAuxLine(y)}if(h>1&&t.autoscale&&r!==h-1){e.dividerColor?Array.isArray(e.dividerColor)&&(e.dividerColor=new b(...e.dividerColor)):e.dividerColor=new b(1,1,1,1);let y=new v(e.dividerColor,2);y.constY(t.autoscale?(r+1)*2/h-1:1),y.arrangeX(),y.xy[2]=1,t.divider=y,i.addAuxLine(y)}if(typeof e.overlay=="object"&&(t.useOverlay||!("useOverlay"in t))){let y=e.nLines-t.position-1;s.fillText(a,20,l.height*(y+.1)/e.nLines),s.fillText(`${Math.floor(m)===m?m:m?.toFixed(5)} ${t.units?t.units:""}`,l.width-70,l.height*(y+.1)/e.nLines),s.fillText(`${Math.floor(f)===f?f:f?.toFixed(5)} ${t.units?t.units:""}`,l.width-70,l.height*(y+.9)/e.nLines)}r++}return requestAnimationFrame(o.anim),this.plots[e._id]}deinitPlot(e){return typeof e=="string"&&(e=this.plots[e]),e.plot.clear(),e.plot.removeAllLines(),!0}reinitPlot(e,i){if(typeof e=="string"){let n=e;e=this.plots[e],i._id||(i._id=n)}if(!!e.plot)return e.plot.clear(),e.plot.removeAllLines(),e.settings.overlayCtx&&e.settings.overlayCtx.clearRect(0,0,e.settings.overlay?.width,e.settings.overlay?.height),this.initPlot(i,e.plot)}getChartSettings(e,i){let n=this.plots[e];if(n){let o=Object.assign({},n.initial);for(let r in n.initial.lines)typeof n.initial.lines[r]?.ymax!="number"&&(o.lines[r].ymax=n.settings.lines[r]?.ymax),typeof n.initial.lines[r]?.ymin!="number"&&(o.lines[r].ymin=n.settings.lines[r]?.ymin),i&&(o.lines[r].values=n.settings.lines[r].values);return delete o.canvas,delete o.overlay,delete o.overlayCtx,o}}update(e,i,n=!0){if(typeof e=="string"&&(e=this.plots[e]),!e)return!1;if(i){let o=!1,r,h;typeof e.settings.overlay=="object"&&(r=e.settings.overlay,h=e.settings.overlayCtx,h.clearRect(0,0,e.settings.overlay.width,e.settings.overlay.height),h.font="1em Courier",h.fillStyle=e.settings.overlayColor?e.settings.overlayColor:"white");for(let l in i)if(e.settings.lines[l]&&e.settings.lines[l].line){if(e.settings.lines[l]?.viewing===!1)continue;let s=e.settings.lines[l];if(Array.isArray(i[l])?g.circularBuffer(s.values,i[l]):typeof i[l]=="number"?(s.values.push(i[l]),s.values.shift()):i[l]?.values&&g.circularBuffer(s.values,i[l].values),s.values){isNaN(s.ymax)&&(isNaN(s.ymin)?s.ymax=0:s.ymax=s.values.length<=1e5?Math.max(...s.values):1),isNaN(s.ymin)&&(isNaN(s.ymax)||(s.ymin=s.values.length<=1e5?Math.min(...s.values):1),s.ymin=0);let a=s.ymin,t=s.ymax;if(a===t)t=s.values.length<=1e5?Math.max(...s.values):1,a=s.values.length<=1e5?Math.min(...s.values):0;else if(typeof e.initial.lines[l]?.ymin!="number"&&(e.settings.overlay||s.autoscale)){t=s.values.length<=1e5?Math.max(...s.values,s.ymax):1,a=s.values.length<=1e5?Math.min(...s.values,s.ymin):0,s.ymin=a,s.ymax=t;let u=Math.abs(s.ymin);s.absmax=u>s.ymax?u:s.ymax}else typeof s.ymax=="number"&&(typeof s.ymin!="number"&&(s.ymin=0),s.ymin>s.ymax&&(t=s.ymin,s.ymin=s.ymax,s.ymax=t));if(typeof a!="number"&&(a=s.values.length<=1e5?Math.min(...s.values,s.ymin):0),typeof t!="number"&&(t=s.values.length<=1e5?Math.max(...s.values,s.ymax):1),s.autoscale?s.autoscale===2?s.scaled=g.autoscale(s.values,s.position,e.settings.nLines,s.centerZero,a,t,s.clamp):(s.scaled=s.values,s.line.offsetY=g.getYOffset(s.position,e.settings.nLines),s.line.scaleY=g.getYScalar(s.values,e.settings.nLines,s.centerZero,a,t)):s.scaled=s.values,s.scaled.length!==s.points&&(s.interpolate?s.values.length>s.points?s.scaled=g.downsample(s.scaled,s.points):s.scaled.length<s.points&&(s.scaled=g.upsample(s.scaled,s.points)):s.scaled.length>s.points?s.scaled.splice(0,s.scaled.length-s.points):s.scaled=new Array(s.points).fill(0).splice(s.points-s.scaled.length,0,s.scaled)),s.scaled.forEach((u,f)=>{!s.autoscale&&s.absmax>1?s.line.setY(f,u/s.absmax):s.line.setY(f,u)}),typeof e.settings.overlay=="object"&&(s.useOverlay||!("useOverlay"in s))){let u=e.settings.nLines-s.position-1;h.fillText(l,20,r.height*(u+.1)/e.settings.nLines),h.fillText(`${Math.floor(t)===t?t:t?.toFixed(5)} ${s.units?s.units:""}`,r.width-70,r.height*(u+.1)/e.settings.nLines),h.fillText(`${Math.floor(a)===a?a:a?.toFixed(5)} ${s.units?s.units:""}`,r.width-70,r.height*(u+.9)/e.settings.nLines)}}}else e.settings.generateNewLines&&!l.includes("timestamp")&&(Array.isArray(i[l])&&(i[l]={values:i[l]}),!i[l].nSec&&!i[l].nPoints&&(i[l].nPoints=1e3),o=!0);if(o)return e.settings.cleanGeneration||Object.keys(e.initial.lines).forEach(l=>{i[l]?i[l]=Object.assign(e.initial.lines[l],i[l]):i[l]=e.initial.lines[l]}),this.reinitPlot(e,{_id:e.settings._id,lines:i}),!0}if(typeof e.settings.overlay=="object"){let o=e.settings.overlay,r=e.settings.overlayCtx;r.clearRect(0,0,e.settings.overlay.width,e.settings.overlay.height),r.font="1em Courier",r.fillStyle="white";for(let h in e.settings.lines){let l=e.settings.lines[h];if(l.useOverlay||!("useOverlay"in l)){let s=e.settings.nLines-l.position-1;r.fillText(h,20,o.height*(s+.1)/e.settings.nLines),r.fillText(`${Math.floor(l.ymax)===l.ymax?l.ymax:l.ymax?.toFixed(5)} ${l.units?l.units:""}`,o.width-70,o.height*(s+.1)/e.settings.nLines),r.fillText(`${Math.floor(l.ymin)===l.ymin?l.ymin:l.ymin?.toFixed(5)} ${l.units?l.units:""}`,o.width-70,o.height*(s+.9)/e.settings.nLines)}}}return n&&requestAnimationFrame(e.anim),!0}updateLine(e,i,n,o,r,h,l){return e.numPoints!==i.length&&(n?e.numPoints>i.length?i=g.downsample(i,e.numPoints):e.numPoints<i.length&&(i=g.upsample(i,e.numPoints)):i.length>e.numPoints?i=i.slice(i.length-e.numPoints):i=[...new Array(i.length).fill(0),...i]),o&&(i=g.autoscale(i,r,h,l)),i.forEach((s,a)=>e.setY(a,s)),!0}static autoscale(e,i=0,n=1,o=!1,r,h,l){if(e?.length===0)return e;let s=typeof h=="number"?h:e.length<=1e5?Math.max(...e):1,a=typeof r=="number"?r:e.length<=1e5?Math.min(...e):0,t=1/n,u=1;if(o){let f=Math.max(Math.abs(a),Math.abs(s));return f!==0&&(u=t/f),e.map(m=>(l&&(m<a&&(m=a),m>s&&(m=s)),m*u+(t*(i+1)*2-1-t)))}else return s===a?s!==0?u=t/s:a!==0&&(u=t/Math.abs(a)):u=t/(s-a),e.map(f=>(l&&(f<a&&(f=a),f>s&&(f=s)),2*((f-a)*u-1/(2*n))+(t*(i+1)*2-1-t)))}static getYScalar(e,i=1,n=!1,o,r){if(e?.length===0)return e;let h=typeof r=="number"?r:e.length<=1e5?Math.max(...e):1,l=typeof o=="number"?o:e.length<=1e5?Math.min(...e):0,s=1/i,a=1;if(n){let t=Math.max(Math.abs(l),Math.abs(h));return t!==0&&(a=s/t),2*a}else return h===l?h!==0?a=s/h:l!==0&&(a=s/Math.abs(l)):a=s/(h-l),2*a}static getYOffset(e=0,i=1){let n=1/i;return n*(e+1)*2-1-n}static absmax(e){return Math.max(Math.abs(Math.min(...e)),Math.max(...e))}static downsample(e,i,n=1){if(e.length>i){let o=new Array(i),r=e.length/i,h=e.length-1,l=0,s=0;for(let a=r;a<e.length;a+=r){let t=Math.round(a);t>h&&(t=h);for(let u=l;u<t;u++)o[s]+=e[u];o[s]/=(t-l)*n,s++,l=t}return o}else return e}static upsample(e,i,n=1){var o=function(f,m,d){return(f+(m-f)*d)*n},r=new Array(i),h=(e.length-1)/(i-1);r[0]=e[0];for(var l=1;l<i-1;l++){var s=l*h,a=Math.floor(s),t=Math.ceil(s),u=s-a;r[l]=o(e[a],e[t],u)}return r[i-1]=e[e.length-1],r}static interpolate(e,i,n=1){return e.length>i?g.downsample(e,i,n):e.length<i?g.upsample(e,i,n):e}static HSLToRGB(e,i,n,o=255){i/=100,n/=100;let r=(1-Math.abs(2*n-1))*i,h=r*(1-Math.abs(e/60%2-1)),l=n-r/2,s=0,a=0,t=0;return 0<=e&&e<60?(s=r,a=h,t=0):60<=e&&e<120?(s=h,a=r,t=0):120<=e&&e<180?(s=0,a=r,t=h):180<=e&&e<240?(s=0,a=h,t=r):240<=e&&e<300?(s=h,a=0,t=r):300<=e&&e<360&&(s=r,a=0,t=h),s=(s+l)*o,a=(a+l)*o,t=(t+l)*o,[s,a,t]}static circularBuffer(e,i){if(i.length<e.length){let n=e.slice(i.length),o=e.length;e.splice(0,o,...n,...i)}else if(i.length>e.length){let n=e.length;e.splice(0,n,i.slice(n-i.length))}else e.splice(0,e.length,...i);return e}static formatDataForCharts(e,i){if(Array.isArray(e)){if(Array.isArray(e[0])){let n={};if(e.forEach((o,r)=>{n[r]=o}),e=n,isNaN(e[0][0]))return}else if(i){if(e={[i]:e},isNaN(e[i][0]))return}else if(e={0:e},isNaN(e[0][0]))return}else if(typeof e=="object"){for(let n in e)if(typeof e[n]=="number"?e[n]=[e[n]]:e[n]?.values&&typeof e[n].values=="number"&&(e[n].values=[e[n].values]),isNaN(e[n][0]))return}else if(typeof e=="string"){let n;if(e.includes(`\r
`)){let o=e.split(`\r
`);e={},o.forEach((r,h)=>{r.includes("	")?n=r.split("	"):r.includes(",")?n=r.split(","):r.includes("|")&&(n=r.split("|")),n&&n.forEach((l,s)=>{if(l.includes(":")){let[a,t]=l.split(":"),u=parseFloat(t);isNaN(u)||(e[a]=[u])}else{let a=parseFloat(l);isNaN(a)||(e[s]=[a])}})})}else e.includes("	")?n=e.split("	"):e.includes(",")?n=e.split(","):e.includes("|")&&(n=e.split("|"));e={},n&&n.forEach((o,r)=>{if(o.includes(":")){let[h,l]=o.split(":"),s=parseFloat(l);isNaN(s)||(e[h]=[s])}else{let h=parseFloat(o);isNaN(h)||(e[r]=[h])}})}else typeof e=="number"&&(i?e={[i]:[e]}:e={0:[e]});return e}static padTime(e,i,n,o){let r=(e[0]-i)/n/o;return[...new Array(o-e.length).map((l,s)=>i+r*(s+1)),...e]}static interpolateForTime(e,i,n){return g.interpolate(e,Math.ceil(n*i))}};})();
